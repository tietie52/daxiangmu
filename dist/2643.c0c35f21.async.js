"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2643],{72643:function(re,P,u){u.r(P);var b=u(26068),E=u.n(b),L=u(90228),f=u.n(L),M=u(87999),O=u.n(M),S=u(48305),_=u.n(S),v=u(75271),j=u(18380),l=u(2336),T=u(79654),U=u(6778),I=u(8797),A=u(14218),D=u(73320),x=u(81114),g=u(48625),s=u(54584),c=u(73323),C=u(17023),d=u(4093),te=u(90023),ue=u(3750),ie=u(62222),de=u(61032),se=u(16483),Y=u.n(se),e=u(52676),le=j.default.RangePicker,oe=function(){var _e=l.Z.useForm(),ce=_()(_e,1),F=ce[0],me=(0,v.useState)(!1),z=_()(me,2),he=z[0],G=z[1],ve=(0,v.useState)([]),$=_()(ve,2),pe=$[0],Ee=$[1],fe=(0,v.useState)(0),Q=_()(fe,2),De=Q[0],Ie=Q[1],xe=(0,v.useState)("warehouse"),V=_()(xe,2),y=V[0],ge=V[1],Ce=(0,v.useState)([]),H=_()(Ce,2),je=H[0],ye=H[1],Pe=(0,v.useState)([]),X=_()(Pe,2),Me=X[0],Oe=X[1],Te=(0,de.useModel)("@@initialState"),W=Te.initialState,m=W==null?void 0:W.wmsStore,o=(0,v.useRef)({pageNum:1,pageSize:10,itemName:"",itemCode:"",skuName:"",skuCode:"",areaId:void 0,warehouseId:void 0,batchNo:"",daysToExpires:void 0,createTimeRange:void 0});(0,v.useEffect)(function(){Ae(),Fe(),w()},[]);var Ae=function(){var r=O()(f()().mark(function a(){var n;return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,ie.d8)();case 3:n=t.sent,console.log("warehouseList:",n),ye(n.data),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),T.ZP.error("\u83B7\u53D6\u4ED3\u5E93\u5217\u8868\u5931\u8D25");case 11:case"end":return t.stop()}},a,null,[[0,8]])}));return function(){return r.apply(this,arguments)}}(),Fe=function(){var r=O()(f()().mark(function a(){var n;return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,ue.sA)();case 3:n=t.sent,console.log("area:",n),Oe(n.data),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),T.ZP.error("\u83B7\u53D6\u5E93\u533A\u5217\u8868\u5931\u8D25");case 11:case"end":return t.stop()}},a,null,[[0,8]])}));return function(){return r.apply(this,arguments)}}(),w=function(){var r=O()(f()().mark(function a(){var n,i,t;return f()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return n=E()({},o.current),n.createTimeRange&&(n.createStartTime=n.createTimeRange[0],n.createEndTime=n.createTimeRange[1]),G(!0),h.prev=3,h.next=6,(0,te.fN)(n);case 6:i=h.sent,t=i.rows.map(function(p){if(y==="warehouse"){var B,K;return E()(E()({},p),{},{areaIdAndItemId:"".concat(p.areaId,"-").concat((B=p.item)===null||B===void 0?void 0:B.id),areaIdAndSkuId:"".concat(p.areaId,"-").concat((K=p.itemSku)===null||K===void 0?void 0:K.id)})}else{var N,Z,k;return E()(E()({},p),{},{itemId:(N=p.item)===null||N===void 0?void 0:N.id,skuIdAndWarehouseId:"".concat((Z=p.itemSku)===null||Z===void 0?void 0:Z.id,"-").concat(p.warehouseId),skuIdAndAreaId:"".concat((k=p.itemSku)===null||k===void 0?void 0:k.id,"-").concat(p.areaId)})}}),Ee(t),Ie(i.total),h.next=15;break;case 12:h.prev=12,h.t0=h.catch(3),T.ZP.error("\u83B7\u53D6\u5E93\u5B58\u660E\u7EC6\u6570\u636E\u5931\u8D25");case 15:return h.prev=15,G(!1),h.finish(15);case 18:case"end":return h.stop()}},a,null,[[3,12,15,18]])}));return function(){return r.apply(this,arguments)}}(),J=function(){o.current.pageNum=1,w()},we=function(){F.resetFields(),o.current={pageNum:1,pageSize:10,itemName:"",itemCode:"",skuName:"",skuCode:"",areaId:void 0,warehouseId:void 0,batchNo:"",daysToExpires:void 0,createTimeRange:void 0},J()},Re=function(a){ge(a.target.value),o.current.areaId=void 0,F.setFieldsValue({areaId:void 0}),o.current.pageNum=1};(0,v.useEffect)(function(){w()},[y]);var be=function(a){o.current.warehouseId=a,o.current.areaId=void 0,F.setFieldsValue({areaId:void 0})},Le=function(a){o.current.pageNum=a.current,o.current.pageSize=a.pageSize,w()},q=function(a){var n=je.find(function(i){return i.id===a})||(m==null?void 0:m.warehouseMap.get(a));return(n==null?void 0:n.warehouseName)||""},ee=function(a){var n=Me.find(function(i){return i.id===a})||(m==null?void 0:m.areaMap.get(a));return(n==null?void 0:n.areaName)||""},R=function(a){return Y()(a).format("YYYY-MM-DD")},ne=function(a){return Y()(a).format("YYYY-MM-DD HH:mm")},Se=y==="warehouse"?[{title:"\u4ED3\u5E93",dataIndex:"warehouseId",render:function(a){return(0,e.jsx)("div",{children:q(a)})}},{title:"\u5E93\u533A",dataIndex:"areaId",render:function(a){return(0,e.jsx)("div",{children:ee(a)})}},{title:"\u5546\u54C1\u4FE1\u606F",dataIndex:"areaIdAndItemId",render:function(a,n){var i,t;return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(i=n.item)===null||i===void 0?void 0:i.itemName}),((t=n.item)===null||t===void 0?void 0:t.itemCode)&&(0,e.jsxs)("div",{children:["\u5546\u54C1\u7F16\u53F7\uFF1A",n.item.itemCode]})]})}},{title:"\u89C4\u683C\u4FE1\u606F",dataIndex:"areaIdAndSkuId",render:function(a,n){var i,t;return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(i=n.itemSku)===null||i===void 0?void 0:i.skuName}),((t=n.itemSku)===null||t===void 0?void 0:t.skuCode)&&(0,e.jsxs)("div",{children:["\u89C4\u683C\u7F16\u53F7\uFF1A",n.itemSku.skuCode]})]})}},{title:"\u5165\u5E93\u65E5\u671F",dataIndex:"createTime",render:function(a){return(0,e.jsx)("div",{children:ne(a)})}},{title:"\u5E93\u5B58",dataIndex:"quantity",align:"right",render:function(a){return(0,e.jsx)(U.Z,{value:a,precision:0,valueStyle:{fontSize:"14px"}})}},{title:"\u6279\u53F7",dataIndex:"batchNo"},{title:"\u751F\u4EA7\u65E5\u671F/\u8FC7\u671F\u65E5\u671F",render:function(a,n){return(0,e.jsxs)("div",{children:[n.productionDate&&(0,e.jsxs)("div",{children:["\u751F\u4EA7\u65E5\u671F\uFF1A",R(n.productionDate)]}),n.expirationDate&&(0,e.jsxs)("div",{children:["\u8FC7\u671F\u65E5\u671F\uFF1A",R(n.expirationDate)]})]})}}]:[{title:"\u5546\u54C1\u4FE1\u606F",dataIndex:"itemId",render:function(a,n){var i,t;return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(i=n.item)===null||i===void 0?void 0:i.itemName}),((t=n.item)===null||t===void 0?void 0:t.itemCode)&&(0,e.jsxs)("div",{children:["\u5546\u54C1\u7F16\u53F7\uFF1A",n.item.itemCode]})]})}},{title:"\u89C4\u683C\u4FE1\u606F",dataIndex:"skuId",render:function(a,n){var i,t;return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:(i=n.itemSku)===null||i===void 0?void 0:i.skuName}),((t=n.itemSku)===null||t===void 0?void 0:t.skuCode)&&(0,e.jsxs)("div",{children:["\u89C4\u683C\u7F16\u53F7\uFF1A",n.itemSku.skuCode]})]})}},{title:"\u4ED3\u5E93",dataIndex:"skuIdAndWarehouseId",render:function(a,n){return(0,e.jsx)("div",{children:q(n.warehouseId)})}},{title:"\u6240\u5C5E\u5E93\u533A",dataIndex:"skuIdAndAreaId",render:function(a,n){return(0,e.jsx)("div",{children:ee(n.areaId)})}},{title:"\u5165\u5E93\u65E5\u671F",dataIndex:"createTime",render:function(a){return(0,e.jsx)("div",{children:ne(a)})}},{title:"\u5E93\u5B58",dataIndex:"quantity",align:"right",render:function(a){return(0,e.jsx)(U.Z,{value:a,precision:0,valueStyle:{fontSize:"14px"}})}},{title:"\u6279\u53F7",dataIndex:"batchNo"},{title:"\u751F\u4EA7\u65E5\u671F/\u8FC7\u671F\u65E5\u671F",render:function(a,n){return(0,e.jsxs)("div",{children:[n.productionDate&&(0,e.jsxs)("div",{children:["\u751F\u4EA7\u65E5\u671F\uFF1A",R(n.productionDate)]}),n.expirationDate&&(0,e.jsxs)("div",{children:["\u8FC7\u671F\u65E5\u671F\uFF1A",R(n.expirationDate)]})]})}}];return(0,e.jsxs)(c._z,{children:[(0,e.jsx)(I.Z,{children:(0,e.jsx)(l.Z,{form:F,layout:"inline",onValuesChange:function(a){Object.entries(a).forEach(function(n){var i=_()(n,2),t=i[0],ae=i[1];o.current[t]=ae})},children:(0,e.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u7EF4\u5EA6",name:"queryType",initialValue:y,children:(0,e.jsxs)(A.ZP.Group,{onChange:Re,children:[(0,e.jsx)(A.ZP.Button,{value:"warehouse",children:"\u4ED3\u5E93\u5E93\u533A"}),(0,e.jsx)(A.ZP.Button,{value:"item",children:"\u5546\u54C1"})]})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u4ED3\u5E93",name:"warehouseId",children:(0,e.jsx)(D.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u4ED3\u5E93",onChange:be,allowClear:!0,showSearch:!0,optionFilterProp:"label",children:m==null?void 0:m.warehouseList.map(function(r){return(0,e.jsx)(Option,{value:r.id,label:r.warehouseName,children:r.warehouseName},r.id)})})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u5E93\u533A",name:"areaId",children:(0,e.jsx)(D.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u5E93\u533A",disabled:!o.current.warehouseId||y==="item",allowClear:!0,showSearch:!0,optionFilterProp:"label",children:m==null?void 0:m.areaList.filter(function(r){return r.warehouseId===o.current.warehouseId}).map(function(r){return(0,e.jsx)(Option,{value:r.id,label:r.areaName,children:r.areaName},r.id)})})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u5546\u54C1\u540D\u79F0",name:"itemName",children:(0,e.jsx)(x.Z,{placeholder:"\u5546\u54C1\u540D\u79F0",allowClear:!0})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u5546\u54C1\u7F16\u53F7",name:"itemCode",children:(0,e.jsx)(x.Z,{placeholder:"\u5546\u54C1\u7F16\u53F7",allowClear:!0})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u89C4\u683C\u540D\u79F0",name:"skuName",children:(0,e.jsx)(x.Z,{placeholder:"\u89C4\u683C\u540D\u79F0",allowClear:!0})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u89C4\u683C\u7F16\u53F7",name:"skuCode",children:(0,e.jsx)(x.Z,{placeholder:"\u89C4\u683C\u7F16\u53F7",allowClear:!0})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u6279\u53F7",name:"batchNo",children:(0,e.jsx)(x.Z,{placeholder:"\u6279\u53F7",allowClear:!0})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u8FC7\u671F",name:"daysToExpires",children:(0,e.jsxs)(D.Z,{style:{width:"100%"},allowClear:!0,children:[(0,e.jsx)(Option,{value:30,children:"30\u5929\u5185"}),(0,e.jsx)(Option,{value:60,children:"60\u5929\u5185"}),(0,e.jsx)(Option,{value:90,children:"90\u5929\u5185"}),(0,e.jsx)(Option,{value:120,children:"120\u5929\u5185"}),(0,e.jsx)(Option,{value:180,children:"180\u5929\u5185"}),(0,e.jsx)(Option,{value:365,children:"365\u5929\u5185"})]})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px"},children:(0,e.jsx)(l.Z.Item,{label:"\u5165\u5E93\u65E5\u671F",name:"createTimeRange",children:(0,e.jsx)(le,{style:{width:"100%"},format:"YYYY-MM-DD",placeholder:["\u5F00\u59CB\u65E5\u671F","\u7ED3\u675F\u65E5\u671F"]})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 4)",padding:"8px",marginLeft:"32px"},children:(0,e.jsxs)(l.Z.Item,{children:[(0,e.jsx)(g.ZP,{type:"primary",icon:(0,e.jsx)(C.Z,{}),onClick:J,children:"\u641C\u7D22"}),(0,e.jsx)(g.ZP,{icon:(0,e.jsx)(d.Z,{}),onClick:we,style:{marginLeft:8},children:"\u91CD\u7F6E"})]})})]})})}),(0,e.jsxs)(I.Z,{style:{marginTop:"20px"},children:[(0,e.jsx)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"16px"},children:(0,e.jsx)("div",{style:{fontSize:"large"},children:"\u5E93\u5B58\u660E\u7EC6"})}),(0,e.jsx)(s.Z,{dataSource:pe,columns:Se,rowKey:function(a){return"".concat(a.id)},loading:he,bordered:!0,pagination:{current:o.current.pageNum,pageSize:o.current.pageSize,total:De,showSizeChanger:!0,onChange:Le},scroll:{x:"max-content"}})]})]})};P.default=oe},90023:function(re,P,u){u.d(P,{fN:function(){return S},tB:function(){return v}});var b=u(90228),E=u.n(b),L=u(87999),f=u.n(L),M=u(61032),O=u(18606);function S(s){return _.apply(this,arguments)}function _(){return _=f()(E()().mark(function s(c){return E()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,M.request)("/api/wms/inventoryDetail/list",{method:"GET",params:c}));case 1:case"end":return d.stop()}},s)})),_.apply(this,arguments)}function v(s){return j.apply(this,arguments)}function j(){return j=f()(E()().mark(function s(c){return E()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,M.request)("/api/wms/inventoryDetail/listNoPage",{method:"GET",params:c}));case 1:case"end":return d.stop()}},s)})),j.apply(this,arguments)}function l(s,c){return downLoadXlsx("/api/wms/inventoryDetail/export",{params:s},"inventoryDetail_".concat(new Date().getTime(),".xlsx"))}function T(s){return request("/api/wms/inventoryDetail/".concat(s),{method:"GET"})}function U(s){return I.apply(this,arguments)}function I(){return I=_asyncToGenerator(_regeneratorRuntime().mark(function s(c){return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",request("/api/wms/inventoryDetail",{method:"POST",data:c}));case 1:case"end":return d.stop()}},s)})),I.apply(this,arguments)}function A(s){return D.apply(this,arguments)}function D(){return D=_asyncToGenerator(_regeneratorRuntime().mark(function s(c){return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",request("/api/wms/inventoryDetail",{method:"PUT",data:c}));case 1:case"end":return d.stop()}},s)})),D.apply(this,arguments)}function x(s){return g.apply(this,arguments)}function g(){return g=_asyncToGenerator(_regeneratorRuntime().mark(function s(c){return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",request("/api/wms/inventoryDetail/".concat(c),{method:"DELETE"}));case 1:case"end":return d.stop()}},s)})),g.apply(this,arguments)}}}]);
