"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[5260,3016],{75260:function(Z,_,e){e.r(_),e.d(_,{default:function(){return B}});var C=e(48305),m=e.n(C),x=e(75271),h=e(79654),E=e(51162),g=e(57355),c=e(23102),d=e(61312),P=e(48625),M=e(63710),o=e(61032),D=e(27874),T=e(30717),U=e(83016),R={avatarPreview:"avatarPreview___aVJPD"},v=e(15739),n=e(4093),f=e(28793),L=e(16621),I=e(21862),s=e(52676),b=function(O){var i=(0,x.useRef)(null),w=(0,x.useState)(),A=m()(w,2),t=A[0],r=A[1],l=(0,x.useState)(),y=m()(l,2),u=y[0],F=y[1];(0,x.useEffect)(function(){r(O.data)},[O]);var z=(0,o.useIntl)(),N=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.getCroppedCanvas().toBlob(function(Y){var K=new FormData;K.append("avatarfile",Y),(0,D.gg)(K).then(function(S){S.code===200?(h.ZP.success(S.msg),O.onFinished(!0)):h.ZP.warning(S.msg)})},"image/png")},G=function(){O.onFinished(!1)},$=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;F(p.getCroppedCanvas().toDataURL())},Q=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.rotate(90)},J=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.rotate(-90)},V=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.zoom(.1)},X=function(){var a=i==null?void 0:i.current,p=a==null?void 0:a.cropper;p.zoom(-.1)},H=function(a){var p=new FileReader;p.readAsDataURL(a),p.onload=function(){r(p.result)}};return(0,s.jsxs)(E.Z,{width:800,title:z.formatMessage({id:"system.user.modify_avatar",defaultMessage:"\u4FEE\u6539\u5934\u50CF"}),open:O.open,destroyOnClose:!0,onOk:N,onCancel:G,children:[(0,s.jsxs)(g.Z,{gutter:[16,16],children:[(0,s.jsx)(c.Z,{span:12,order:1,children:(0,s.jsx)(T.f,{ref:i,src:t,style:{height:350,width:"100%",marginBottom:"16px"},initialAspectRatio:1,guides:!1,crop:$,zoomable:!0,zoomOnWheel:!0,rotatable:!0})}),(0,s.jsx)(c.Z,{span:12,order:2,children:(0,s.jsx)("div",{className:R.avatarPreview,children:(0,s.jsx)("img",{src:u,style:{height:"100%",width:"100%"}})})})]}),(0,s.jsxs)(g.Z,{gutter:[16,16],children:[(0,s.jsx)(c.Z,{span:6,children:(0,s.jsx)(d.Z,{beforeUpload:H,maxCount:1,children:(0,s.jsxs)(P.ZP,{children:[(0,s.jsx)(v.Z,{}),"\u4E0A\u4F20"]})})}),(0,s.jsx)(c.Z,{children:(0,s.jsxs)(M.Z,{children:[(0,s.jsx)(P.ZP,{icon:(0,s.jsx)(n.Z,{}),onClick:Q}),(0,s.jsx)(P.ZP,{icon:(0,s.jsx)(f.Z,{}),onClick:J}),(0,s.jsx)(P.ZP,{icon:(0,s.jsx)(L.Z,{}),onClick:V}),(0,s.jsx)(P.ZP,{icon:(0,s.jsx)(I.Z,{}),onClick:X})]})})]})]})},B=b},27874:function(Z,_,e){e.d(_,{Lj:function(){return b},Nq:function(){return R},PR:function(){return D},_L:function(){return L},az:function(){return I},cn:function(){return T},gg:function(){return O},kX:function(){return n},lE:function(){return M},tW:function(){return w},wp:function(){return W},x7:function(){return A},xB:function(){return B}});var C=e(90228),m=e.n(C),x=e(26068),h=e.n(x),E=e(87999),g=e.n(E),c=e(71980),d=e(61032),P=e(18606);function M(t,r){return o.apply(this,arguments)}function o(){return o=g()(m()().mark(function t(r,l){return m()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,d.request)("/api/system/user/list",h()({method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8"},params:h()({pageNum:r.current,pageSize:r.pageSize},r)},l||{})));case 1:case"end":return u.stop()}},t)})),o.apply(this,arguments)}function D(t,r){return(0,d.request)("/api/system/user/".concat(t),h()({method:"GET"},r||{}))}function T(t,r){return U.apply(this,arguments)}function U(){return U=g()(m()().mark(function t(r,l){return m()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,d.request)("/api/system/user",h()({method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8"},data:r},l||{})));case 1:case"end":return u.stop()}},t)})),U.apply(this,arguments)}function R(t,r){return v.apply(this,arguments)}function v(){return v=g()(m()().mark(function t(r,l){return m()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,d.request)("/api/system/user",h()({method:"PUT",headers:{"Content-Type":"application/json;charset=UTF-8"},data:r},l||{})));case 1:case"end":return u.stop()}},t)})),v.apply(this,arguments)}function n(t,r){return f.apply(this,arguments)}function f(){return f=g()(m()().mark(function t(r,l){return m()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,d.request)("/api/system/user/".concat(r),h()({method:"DELETE"},l||{})));case 1:case"end":return u.stop()}},t)})),f.apply(this,arguments)}function L(t,r){return(0,P.su)("/api/system/user/export",{params:t},"user_".concat(new Date().getTime(),".xlsx"))}function I(t,r){var l={userId:t,status:r};return(0,d.request)("/api/system/user/changeStatus",{method:"put",data:l})}function s(){return request("/api/system/user/profile",{method:"get"})}function b(t){return(0,d.request)("/api/system/user/profile",{method:"put",data:t})}function B(t,r){var l={userId:t,password:r};return(0,d.request)("/api/system/user/resetPwd",{method:"put",data:l})}function W(t,r){var l={oldPassword:t,newPassword:r};return(0,d.request)("/api/system/user/profile/updatePwd",{method:"put",params:l})}function O(t){return(0,d.request)("/api/system/user/profile/avatar",{method:"post",data:t})}function i(t){return request("/system/user/authRole/"+t,{method:"get"})}function w(t){return(0,d.request)("/system/user/authRole",{method:"put",params:t})}function A(t){return new Promise(function(r){(0,d.request)("/api/system/user/deptTree",{method:"get",params:t}).then(function(l){if(l&&l.code===200){var y=(0,c.lt)(l.data);r(y)}else r([])})})}},71980:function(Z,_,e){e.d(_,{C2:function(){return m},lt:function(){return h}});var C=e(77420);function m(E,g,c,d,P,M){var o={id:g||"id",name:c||"name",parentId:d||"parentId",parentName:P||"parentName",childrenList:M||"children"},D=[],T=[],U=[];E.forEach(function(v){var n=v,f=n[o.parentId];D[f]||(D[f]=[]),n.key=n[o.id],n.title=n[o.name],n.value=n[o.id],n[o.childrenList]=null,T[n[o.id]]=n,D[f].push(n)}),E.forEach(function(v){var n=v,f=n[o.parentId];T[f]||(n[o.parentName]="",U.push(n))});function R(v){var n=v;D[n[o.id]]&&(n[o.childrenList]||(n[o.childrenList]=[]),n[o.childrenList]=D[n[o.id]]),n[o.childrenList]&&n[o.childrenList].forEach(function(f){var L=f;L[o.parentName]=n[o.name],R(L)})}return U.forEach(function(v){R(v)}),U}var x=function(){return parse(window.location.href.split("?")[1])};function h(E){var g=E.map(function(c){var d={id:c.id,title:c.label,key:"".concat(c.id),value:c.id};return c.children&&(d.children=h(c.children)),d});return g}},83016:function(Z,_,e){e.r(_)},23102:function(Z,_,e){var C=e(47330);_.Z=C.Z},57355:function(Z,_,e){var C=e(98457);_.Z=C.Z}}]);
