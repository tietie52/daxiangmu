"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[5350],{55350:function(re,L,t){t.r(L);var S=t(26068),h=t.n(S),F=t(48305),g=t.n(F),Z=t(90228),u=t.n(Z),B=t(87999),s=t.n(B),v=t(75271),i=t(61032),d=t(79654),P=t(48625),K=t(51162),y=t(73323),w=t(90607),O=t(86743),k=t(16621),R=t(20860),$=t(23193),M=t(91825),z=t(65269),G=t(77034),N=t(66752),V=t(41009),r=t(52676),Y=function(){var e=s()(u()().mark(function a(p,n){var E,f,C;return u()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(E=d.ZP.loading("\u6B63\u5728\u53D6\u6D88\u6388\u6743"),n){o.next=3;break}return o.abrupt("return",!0);case 3:return o.prev=3,f=n.map(function(W){return W.userId}).join(","),o.next=7,(0,M.LA)({roleId:p,userIds:f});case 7:return C=o.sent,E(),C.code===200?d.ZP.success("\u53D6\u6D88\u6388\u6743\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):d.ZP.error(C.msg),o.abrupt("return",!0);case 13:return o.prev=13,o.t0=o.catch(3),E(),d.ZP.error("\u53D6\u6D88\u6388\u6743\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),o.abrupt("return",!1);case 18:case"end":return o.stop()}},a,null,[[3,13]])}));return function(p,n){return e.apply(this,arguments)}}(),H=function(){var e=s()(u()().mark(function a(p,n){var E,f;return u()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return E=d.ZP.loading("\u6B63\u5728\u53D6\u6D88\u6388\u6743"),c.prev=1,c.next=4,(0,M.CE)({userId:n,roleId:p});case 4:return f=c.sent,E(),f.code===200?d.ZP.success("\u53D6\u6D88\u6388\u6743\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"):d.ZP.error(f.msg),c.abrupt("return",!0);case 10:return c.prev=10,c.t0=c.catch(1),E(),d.ZP.error("\u53D6\u6D88\u6388\u6743\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),c.abrupt("return",!1);case 15:case"end":return c.stop()}},a,null,[[1,10]])}));return function(p,n){return e.apply(this,arguments)}}(),J=function(){var a=(0,v.useState)(!1),p=g()(a,2),n=p[0],E=p[1],f=(0,v.useRef)(),C=(0,v.useState)([]),c=g()(C,2),o=c[0],W=c[1],se=(0,v.useState)([]),q=g()(se,2),ee=q[0],ae=q[1],X=(0,i.useAccess)(),ue=(0,i.useIntl)(),te=(0,i.useParams)();te.id===void 0&&i.history.back();var I=te.id||"0";(0,v.useEffect)(function(){(0,z.pX)("sys_normal_disable").then(function(D){ae(D)})},[]);var _e=[{title:(0,r.jsx)(i.FormattedMessage,{id:"system.user.user_id",defaultMessage:"\u7528\u6237\u7F16\u53F7"}),dataIndex:"deptId",valueType:"text"},{title:(0,r.jsx)(i.FormattedMessage,{id:"system.user.user_name",defaultMessage:"\u7528\u6237\u8D26\u53F7"}),dataIndex:"userName",valueType:"text"},{title:(0,r.jsx)(i.FormattedMessage,{id:"system.user.nick_name",defaultMessage:"\u7528\u6237\u6635\u79F0"}),dataIndex:"nickName",valueType:"text"},{title:(0,r.jsx)(i.FormattedMessage,{id:"system.user.phonenumber",defaultMessage:"\u624B\u673A\u53F7\u7801"}),dataIndex:"phonenumber",valueType:"text"},{title:(0,r.jsx)(i.FormattedMessage,{id:"system.role.create_time",defaultMessage:"\u521B\u5EFA\u65F6\u95F4"}),dataIndex:"createTime",valueType:"dateRange",render:function(m,_){return(0,r.jsxs)("span",{children:[_.createTime.toString()," "]})},hideInSearch:!0},{title:(0,r.jsx)(i.FormattedMessage,{id:"system.user.status",defaultMessage:"\u5E10\u53F7\u72B6\u6001"}),dataIndex:"status",valueType:"select",valueEnum:ee,render:function(m,_){return(0,r.jsx)(G.Z,{enums:ee,value:_.status})}},{title:(0,r.jsx)(i.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",width:"60px",valueType:"option",render:function(m,_){return[(0,r.jsx)(P.ZP,{type:"link",size:"small",danger:!0,icon:(0,r.jsx)(O.Z,{}),hidden:!X.hasPerms("system:role:remove"),onClick:s()(u()().mark(function l(){return u()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:K.Z.confirm({title:"\u5220\u9664",content:"\u786E\u8BA4\u8981\u53D6\u6D88\u8BE5\u7528\u6237"+_.userName+'"\u89D2\u8272\u6388\u6743\u5417\uFF1F',okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var x=s()(u()().mark(function b(){var Q;return u()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,H(I,_.userId);case 2:Q=j.sent,Q&&f.current&&f.current.reload();case 4:case"end":return j.stop()}},b)}));function T(){return x.apply(this,arguments)}return T}()});case 1:case"end":return A.stop()}},l)})),children:"\u53D6\u6D88\u6388\u6743"},"remove")]}}];return(0,r.jsxs)(y._z,{children:[(0,r.jsx)("div",{style:{width:"100%",float:"right"},children:(0,r.jsx)(w.Z,{headerTitle:ue.formatMessage({id:"pages.searchTable.title",defaultMessage:"\u4FE1\u606F"}),actionRef:f,rowKey:"userId",search:{labelWidth:120},toolBarRender:function(){return[(0,r.jsxs)(P.ZP,{type:"primary",hidden:!X.hasPerms("system:role:add"),onClick:s()(u()().mark(function m(){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:E(!0);case 1:case"end":return l.stop()}},m)})),children:[(0,r.jsx)(k.Z,{})," ",(0,r.jsx)(i.FormattedMessage,{id:"system.role.auth.addUser",defaultMessage:"\u6DFB\u52A0\u7528\u6237"})]},"add"),(0,r.jsxs)(P.ZP,{type:"primary",danger:!0,hidden:(o==null?void 0:o.length)===0||!X.hasPerms("system:role:remove"),onClick:s()(u()().mark(function m(){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:K.Z.confirm({title:"\u662F\u5426\u786E\u8BA4\u5220\u9664\u6240\u9009\u6570\u636E\u9879?",icon:(0,r.jsx)(R.Z,{}),content:"\u8BF7\u8C28\u614E\u64CD\u4F5C",onOk:function(){return s()(u()().mark(function A(){var x,T,b;return u()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,Y(I,o);case 2:x=U.sent,x&&(W([]),(T=f.current)===null||T===void 0||(b=T.reloadAndRest)===null||b===void 0||b.call(T));case 4:case"end":return U.stop()}},A)}))()},onCancel:function(){}});case 1:case"end":return l.stop()}},m)})),children:[(0,r.jsx)(O.Z,{}),(0,r.jsx)(i.FormattedMessage,{id:"system.role.auth.cancelAll",defaultMessage:"\u6279\u91CF\u53D6\u6D88\u6388\u6743"})]},"remove"),(0,r.jsxs)(P.ZP,{type:"primary",onClick:s()(u()().mark(function m(){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:i.history.back();case 1:case"end":return l.stop()}},m)})),children:[(0,r.jsx)($.Z,{}),(0,r.jsx)(i.FormattedMessage,{id:"pages.goback",defaultMessage:"\u8FD4\u56DE"})]},"back")]},request:function(m){return(0,M.iH)(h()(h()({},m),{},{roleId:I})).then(function(_){var l={data:_.rows,total:_.total,success:!0};return l})},columns:_e,rowSelection:{onChange:function(m,_){W(_)}}},"userList")}),(0,r.jsx)(N.default,{open:n,onSubmit:function(m){var _=m.join(",");if(_===""){d.ZP.warning("\u8BF7\u9009\u62E9\u8981\u5206\u914D\u7684\u7528\u6237");return}(0,M.dY)({roleId:I,userIds:_}).then(function(l){l.code===V.iK.SUCCESS?(d.ZP.success("\u66F4\u65B0\u6210\u529F\uFF01"),f.current&&f.current.reload()):d.ZP.warning(l.msg)}),E(!1)},onCancel:function(){E(!1)},params:{roleId:I},request:function(m){return(0,M.p7)(h()({},m)).then(function(_){var l={data:_.rows,total:_.rows.length,success:!0};return l})}})]})};L.default=J},91825:function(re,L,t){t.d(L,{CE:function(){return r},JV:function(){return i},LA:function(){return Y},Lp:function(){return $},Vl:function(){return J},_d:function(){return K},cY:function(){return P},dY:function(){return H},iH:function(){return N},l5:function(){return k},mj:function(){return M},p7:function(){return V},sp:function(){return G},tm:function(){return z},ul:function(){return w}});var S=t(90228),h=t.n(S),F=t(26068),g=t.n(F),Z=t(87999),u=t.n(Z),B=t(41009),s=t(61032),v=t(18606);function i(e){return d.apply(this,arguments)}function d(){return d=u()(h()().mark(function e(a){return h()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/system/role/list",{method:"GET",headers:{"Content-Type":B.zc.FORM_URLENCODED},params:g()(g()({},a),{},{pageNum:(a==null?void 0:a.current)||1,pageSize:(a==null?void 0:a.pageSize)||10})}));case 1:case"end":return n.stop()}},e)})),d.apply(this,arguments)}function P(e){return(0,s.request)("/api/system/role/".concat(e),{method:"GET"})}function K(e){return y.apply(this,arguments)}function y(){return y=u()(h()().mark(function e(a){return h()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/system/role",{method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8"},data:a}));case 1:case"end":return n.stop()}},e)})),y.apply(this,arguments)}function w(e){return O.apply(this,arguments)}function O(){return O=u()(h()().mark(function e(a){return h()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/system/role",{method:"PUT",headers:{"Content-Type":"application/json;charset=UTF-8"},data:a}));case 1:case"end":return n.stop()}},e)})),O.apply(this,arguments)}function k(e){return R.apply(this,arguments)}function R(){return R=u()(h()().mark(function e(a){return h()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,s.request)("/api/system/role/".concat(a),{method:"DELETE"}));case 1:case"end":return n.stop()}},e)})),R.apply(this,arguments)}function $(e){return(0,v.su)("/api/system/role/export",{params:e},"role_".concat(new Date().getTime(),".xlsx"))}function M(e){return(0,s.request)("/api/system/menu/roleMenuTreeselect/".concat(e),{method:"get"})}function z(e){return(0,s.request)("/api/system/role/dataScope",{method:"put",data:e})}function G(e,a){var p={roleId:e,status:a};return(0,s.request)("/api/system/role/changeStatus",{method:"put",data:p})}function N(e){return(0,s.request)("/api/system/role/authUser/allocatedList",{method:"get",params:e})}function V(e){return(0,s.request)("/api/system/role/authUser/unallocatedList",{method:"get",params:e})}function r(e){return(0,s.request)("/api/system/role/authUser/cancel",{method:"put",data:e})}function Y(e){return(0,s.request)("/api/system/role/authUser/cancelAll",{method:"put",params:e})}function H(e){return(0,s.request)("/api/system/role/authUser/selectAll",{method:"put",params:e,headers:{"Content-Type":B.zc.FORM_URLENCODED}})}function J(e){return(0,s.request)("/api/system/role/deptTree/"+e,{method:"get"})}}}]);
