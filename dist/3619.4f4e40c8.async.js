"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[3619,3705,1717],{73537:function(q,T,n){n.r(T);var A=n(75271),j=n(61032),w=n(51162),r=n(18819),L=n(43242),u=n(95395),d=n(52676),g=function(v){var B=(0,j.useIntl)(),o=[],h=Object.keys(v.data);return h.forEach(function(c){o.push({key:c+"1",label:c.substring(c.lastIndexOf("/")+1,c.indexOf(".vm")),children:(0,d.jsx)(L.default,{className:"java",children:v.data[c]})})}),(0,A.useEffect)(function(){},[]),(0,d.jsx)(w.Z,{width:900,title:B.formatMessage({id:"gen.preview",defaultMessage:"\u9884\u89C8"}),open:v.open,destroyOnClose:!0,footer:!1,onOk:function(){v.onHide()},onCancel:function(){v.onHide()},children:(0,d.jsx)(r.Z,{defaultActiveKey:"1",items:o})})};T.default=g},22372:function(q,T,n){n.r(T);var A=n(26068),j=n.n(A),w=n(48305),r=n.n(w),L=n(90228),u=n.n(L),d=n(87999),g=n.n(d),G=n(30426),v=n(16621),B=n(45659),o=n(79654),h=n(48625),c=n(51162),z=n(8797),K=n(1153),O=n(75271),f=n(61032),H=n(73537),p=n(51717),V=n(90607),W=n(49026),Y=n(60173),s=n(52676),J=B.Z.Content,S=function(){var I=g()(u()().mark(function E(t){var a;return u()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.ZP.loading("\u6B63\u5728\u5220\u9664"),t){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,(0,p.removeData)({ids:t.map(function(i){return i.tableId})});case 6:return a(),o.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),a(),o.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),e.abrupt("return",!1);case 16:case"end":return e.stop()}},E,null,[[3,11]])}));return function(t){return I.apply(this,arguments)}}(),Q=function(){var I=g()(u()().mark(function E(t){var a,_;return u()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a=o.ZP.loading("\u6B63\u5728\u5220\u9664"),t){i.next=3;break}return i.abrupt("return",!0);case 3:return i.prev=3,_=[t.tableId],i.next=7,(0,p.removeData)({ids:_});case 7:return a(),o.ZP.success("\u5220\u9664\u6210\u529F\uFF0C\u5373\u5C06\u5237\u65B0"),i.abrupt("return",!0);case 12:return i.prev=12,i.t0=i.catch(3),a(),o.ZP.error("\u5220\u9664\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),i.abrupt("return",!1);case 17:case"end":return i.stop()}},E,null,[[3,12]])}));return function(t){return I.apply(this,arguments)}}(),F=function(){var E=(0,O.useRef)(),t=(0,O.useState)(!1),a=r()(t,2),_=a[0],e=a[1],i=(0,O.useState)(!1),ee=r()(i,2),ie=ee[0],ne=ee[1],oe=(0,O.useState)(!1),te=r()(oe,2),_e=te[0],de=te[1],$=(0,O.useRef)(),ce=(0,O.useState)(),ae=r()(ce,2),P=ae[0],re=ae[1],pe=(0,O.useState)([]),se=r()(pe,2),b=se[0],ue=se[1],y=(0,f.useAccess)(),le=[{title:"\u7F16\u53F7",dataIndex:"tableId",tip:"\u7F16\u53F7",render:function(M,l){return(0,s.jsx)("a",{onClick:function(){re(l),e(!0)},children:M})}},{title:"\u8868\u540D",dataIndex:"tableName",valueType:"textarea"},{title:"\u8868\u63CF\u8FF0",dataIndex:"tableComment",hideInForm:!0,hideInSearch:!0},{title:"\u5B9E\u4F53",dataIndex:"className",valueType:"textarea"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",valueType:"textarea",hideInSearch:!0},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updateTime",valueType:"textarea",hideInSearch:!0},{title:"\u64CD\u4F5C",dataIndex:"option",width:"220px",valueType:"option",render:function(M,l){return[(0,s.jsx)(h.ZP,{type:"link",size:"small",hidden:!y.hasPerms("tool:gen:edit"),onClick:function(){(0,p.previewCode)(l.tableId).then(function(D){D.code===200?(de(D.data),ne(!0)):o.ZP.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25")})},children:"\u9884\u89C8"},"preview"),(0,s.jsx)(h.ZP,{type:"link",size:"small",hidden:!y.hasPerms("tool:gen:edit"),onClick:function(){f.history.push("/tool/gen/edit?id=".concat(l.tableId))},children:"\u7F16\u8F91"},"config"),(0,s.jsx)(h.ZP,{type:"link",size:"small",danger:!0,hidden:!y.hasPerms("tool:gen:del"),onClick:g()(u()().mark(function m(){return u()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:c.Z.confirm({title:"\u5220\u9664\u4EFB\u52A1",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u4EFB\u52A1\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var N=g()(u()().mark(function x(){var X;return u()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,Q(l);case 2:X=k.sent,X&&$.current&&$.current.reload();case 4:case"end":return k.stop()}},x)}));function R(){return N.apply(this,arguments)}return R}()});case 1:case"end":return Z.stop()}},m)})),children:"\u5220\u9664"},"delete"),(0,s.jsx)(h.ZP,{type:"link",size:"small",hidden:!y.hasPerms("tool:gen:edit"),onClick:function(){(0,p.syncDbInfo)(l.tableName).then(function(D){D.code===200?o.ZP.success("\u540C\u6B65\u6210\u529F"):o.ZP.error("\u540C\u6B65\u5931\u8D25")})},children:"\u540C\u6B65"},"sync"),(0,s.jsx)(h.ZP,{type:"link",size:"small",hidden:!y.hasPerms("tool:gen:edit"),onClick:function(){l.genType==="1"?(0,p.genCode)(l.tableName).then(function(D){D.code===200?o.ZP.success("\u6210\u529F\u751F\u6210\u5230\u81EA\u5B9A\u4E49\u8DEF\u5F84\uFF1A".concat(l.genPath)):o.ZP.error(D.msg)}):(0,p.batchGenCode)(l.tableName)},children:"\u751F\u6210\u4EE3\u7801"},"gencode")]}}];return(0,s.jsx)(J,{children:(0,s.jsxs)(z.Z,{bordered:!1,children:[(0,s.jsx)(V.Z,{headerTitle:"\u4EE3\u7801\u751F\u6210\u4FE1\u606F",actionRef:$,formRef:E,rowKey:"tableId",search:{labelWidth:120},toolBarRender:function(){return[(0,s.jsxs)(h.ZP,{type:"primary",hidden:!y.hasPerms("tool:gen:edit"),onClick:function(){if(b.length===0){o.ZP.error("\u8BF7\u9009\u62E9\u8981\u751F\u6210\u7684\u6570\u636E");return}var l=b.map(function(m){return m.tableName});b[0].genType==="1"?(0,p.genCode)(l.join(",")).then(function(m){m.code===200?o.ZP.success("\u6210\u529F\u751F\u6210\u5230\u81EA\u5B9A\u4E49\u8DEF\u5F84\uFF1A".concat(b[0].genPath)):o.ZP.error(m.msg)}):(0,p.batchGenCode)(l.join(","))},children:[(0,s.jsx)(G.Z,{})," ",(0,s.jsx)(f.FormattedMessage,{id:"gen.gencode",defaultMessage:"\u751F\u6210"})]},"gen"),(0,s.jsxs)(h.ZP,{type:"primary",hidden:!y.hasPerms("tool:gen:add"),onClick:function(){f.history.push("/tool/gen/import")},children:[(0,s.jsx)(v.Z,{})," ",(0,s.jsx)(f.FormattedMessage,{id:"gen.import",defaultMessage:"\u5BFC\u5165"})]},"import")]},request:function(M){return(0,p.getGenCodeList)(j()({},M)).then(function(l){return{data:l.rows,total:l.rows.length,success:!0}})},columns:le,rowSelection:{onChange:function(M,l){ue(l)}}}),(b==null?void 0:b.length)>0&&(0,s.jsx)(W.S,{extra:(0,s.jsxs)("div",{children:[(0,s.jsx)(f.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"\u5DF2\u9009\u62E9"})," ",(0,s.jsx)("a",{style:{fontWeight:600},children:b.length})," ",(0,s.jsx)(f.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"})]}),children:(0,s.jsx)(h.ZP,{hidden:!y.hasPerms("tool:gen:remove"),onClick:g()(u()().mark(function C(){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:c.Z.confirm({title:"\u5220\u9664\u4EFB\u52A1",content:"\u786E\u5B9A\u5220\u9664\u8BE5\u4EFB\u52A1\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var m=g()(u()().mark(function Z(){var N,R,x;return u()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,S(b);case 2:N=U.sent,N&&(ue([]),(R=$.current)===null||R===void 0||(x=R.reloadAndRest)===null||x===void 0||x.call(R));case 4:case"end":return U.stop()}},Z)}));function D(){return m.apply(this,arguments)}return D}()});case 1:case"end":return l.stop()}},C)})),children:(0,s.jsx)(f.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"\u6279\u91CF\u5220\u9664"})},"delete")}),(0,s.jsx)(H.default,{open:ie,data:_e,onHide:function(){ne(!1)}}),(0,s.jsx)(K.Z,{width:600,open:_,onClose:function(){re(void 0),e(!1)},closable:!1,children:(P==null?void 0:P.tableName)&&(0,s.jsx)(Y.vY,{column:2,title:P==null?void 0:P.tableName,request:g()(u()().mark(function C(){return u()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",{data:P||{}});case 1:case"end":return l.stop()}},C)})),params:{id:P==null?void 0:P.tableName},columns:le})})]})})};T.default=F},51717:function(q,T,n){n.r(T),n.d(T,{addData:function(){return H},batchGenCode:function(){return Q},genCode:function(){return J},getGenCode:function(){return B},getGenCodeList:function(){return G},importTables:function(){return z},previewCode:function(){return I},queryTableList:function(){return h},removeData:function(){return O},syncDbInfo:function(){return Y},updateData:function(){return V}});var A=n(26068),j=n.n(A),w=n(90228),r=n.n(w),L=n(87999),u=n.n(L),d=n(61032),g=n(18606);function G(t){return v.apply(this,arguments)}function v(){return v=u()(r()().mark(function t(a){var _;return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return _=new URLSearchParams(a).toString(),i.abrupt("return",(0,d.request)("/api/code/gen/list?".concat(_),{data:a,method:"get",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 2:case"end":return i.stop()}},t)})),v.apply(this,arguments)}function B(t){return o.apply(this,arguments)}function o(){return o=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/code/gen/".concat(a),{method:"get",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return e.stop()}},t)})),o.apply(this,arguments)}function h(t){return c.apply(this,arguments)}function c(){return c=u()(r()().mark(function t(a){var _;return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return _=new URLSearchParams(a).toString(),i.abrupt("return",(0,d.request)("/api/code/gen/db/list?".concat(_),{data:a,method:"get",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 2:case"end":return i.stop()}},t)})),c.apply(this,arguments)}function z(t){return K.apply(this,arguments)}function K(){return K=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/code/gen/importTable?tables=".concat(a),{method:"POST",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return e.stop()}},t)})),K.apply(this,arguments)}function O(t){return f.apply(this,arguments)}function f(){return f=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/code/gen/".concat(a.ids),{method:"delete",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return e.stop()}},t)})),f.apply(this,arguments)}function H(t){return p.apply(this,arguments)}function p(){return p=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/code/gen",{method:"POST",data:j()({},a)}));case 1:case"end":return e.stop()}},t)})),p.apply(this,arguments)}function V(t){return W.apply(this,arguments)}function W(){return W=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/code/gen",{method:"PUT",data:j()({},a)}));case 1:case"end":return e.stop()}},t)})),W.apply(this,arguments)}function Y(t){return s.apply(this,arguments)}function s(){return s=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/code/gen/synchDb/".concat(a),{method:"GET"}));case 1:case"end":return e.stop()}},t)})),s.apply(this,arguments)}function J(t){return S.apply(this,arguments)}function S(){return S=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/code/gen/genCode/".concat(a),{method:"GET"}));case 1:case"end":return e.stop()}},t)})),S.apply(this,arguments)}function Q(t){return F.apply(this,arguments)}function F(){return F=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,g.p6)("/api/code/gen/batchGenCode?tables=".concat(a)));case 1:case"end":return e.stop()}},t)})),F.apply(this,arguments)}function I(t){return E.apply(this,arguments)}function E(){return E=u()(r()().mark(function t(a){return r()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,d.request)("/api/code/gen/preview/".concat(a),{method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8"}}));case 1:case"end":return e.stop()}},t)})),E.apply(this,arguments)}}}]);
