"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4241],{54241:function(ae,w,t){t.r(w);var L=t(15558),y=t.n(L),U=t(26068),v=t.n(U),A=t(90228),g=t.n(A),R=t(87999),C=t.n(R),B=t(48305),o=t.n(B),p=t(75271),T=t(73320),m=t(2336),S=t(79654),D=t(6778),F=t(8797),E=t(14218),j=t(81114),d=t(48625),c=t(76985),I=t(54584),s=t(73323),P=t(17023),te=t(4093),ue=t(2377),se=t(3750),de=t(62222),le=t(61032),e=t(52676),Z=T.Z.Option,ie=function(){var _e=m.Z.useForm(),oe=o()(_e,1),b=oe[0],me=(0,p.useState)(!1),K=o()(me,2),ce=K[0],N=K[1],he=(0,p.useState)([]),k=o()(he,2),pe=k[0],ve=k[1],fe=(0,p.useState)([]),z=o()(fe,2),G=z[0],Ee=z[1],ge=(0,p.useState)([]),$=o()(ge,2),Q=$[0],Ce=$[1],Ie=(0,p.useState)(0),V=o()(Ie,2),ye=V[0],De=V[1],Pe=(0,p.useState)("warehouse"),X=o()(Pe,2),h=X[0],xe=X[1],je=(0,p.useState)(!1),H=o()(je,2),J=H[0],Me=H[1],Oe=(0,p.useState)({}),Y=o()(Oe,2),we=Y[0],Ae=Y[1],Te=(0,le.useModel)("@@initialState"),W=Te.initialState,x=W==null?void 0:W.wmsStore,i=(0,p.useRef)({pageNum:1,pageSize:10,skuId:void 0,warehouseId:void 0,areaId:void 0,itemName:void 0,itemCode:void 0,skuName:void 0,skuCode:void 0,minQuantity:void 0});(0,p.useEffect)(function(){Se(),be(),M()},[]);var Se=function(){var a=C()(g()().mark(function r(){var n;return g()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(0,de.d8)();case 3:n=u.sent,console.log("warehouseList:",n),Ee(n.data),u.next=11;break;case 8:u.prev=8,u.t0=u.catch(0),S.ZP.error("\u83B7\u53D6\u4ED3\u5E93\u5217\u8868\u5931\u8D25");case 11:case"end":return u.stop()}},r,null,[[0,8]])}));return function(){return a.apply(this,arguments)}}(),be=function(){var a=C()(g()().mark(function r(){var n;return g()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,(0,se.sA)();case 3:n=u.sent,console.log("area:",n),Ce(n.data),u.next=11;break;case 8:u.prev=8,u.t0=u.catch(0),S.ZP.error("\u83B7\u53D6\u5E93\u533A\u5217\u8868\u5931\u8D25");case 11:case"end":return u.stop()}},r,null,[[0,8]])}));return function(){return a.apply(this,arguments)}}(),M=function(){var a=C()(g()().mark(function r(){var n,l,u;return g()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return n=v()({},i.current),J?n.minQuantity=1:n.minQuantity=void 0,N(!0),_.prev=3,console.log("getList queryType:",h),_.next=7,(0,ue.Wc)(n,h);case 7:l=_.sent,u=l.rows.map(function(f){return h==="warehouse"?v()(v()({},f),{},{warehouseIdAndItemId:"".concat(f.warehouseId,"-").concat(f.itemSku.itemId)}):h==="area"?v()(v()({},f),{},{areaIdAndItemId:"".concat(f.areaId,"-").concat(f.itemSku.itemId)}):v()(v()({},f),{},{itemId:f.itemSku.itemId,skuIdAndWarehouseId:"".concat(f.skuId,"-").concat(f.warehouseId)})}),console.log("processedData:",u),ve(u),De(l.total),Le(u),_.next=18;break;case 15:_.prev=15,_.t0=_.catch(3),S.ZP.error("\u83B7\u53D6\u5E93\u5B58\u6570\u636E\u5931\u8D25");case 18:return _.prev=18,N(!1),_.finish(18);case 21:case"end":return _.stop()}},r,null,[[3,15,18,21]])}));return function(){return a.apply(this,arguments)}}(),Le=function(r){var n={};if(h==="warehouse"){var l="",u=1;r.forEach(function(O,_){O.warehouseId===l?u++:(_>0&&(n["".concat(_-u,"-0")]=u),l=O.warehouseId,u=1)}),r.length>0&&(n["".concat(r.length-u,"-0")]=u)}Ae(n)},q=function(){i.current.pageNum=1,M()},Ue=function(){b.resetFields(),i.current={pageNum:1,pageSize:10,skuId:void 0,warehouseId:void 0,areaId:void 0,itemName:void 0,itemCode:void 0,skuName:void 0,skuCode:void 0,minQuantity:void 0},q()},Re=function(r){xe(r.target.value),i.current.areaId=void 0,b.setFieldsValue({areaId:void 0}),i.current.pageNum=1};(0,p.useEffect)(function(){M()},[h]);var Be=function(r){Me(r.target.checked),i.current.pageNum=1,M()},Fe=function(r){i.current.warehouseId=r,i.current.areaId=void 0,b.setFieldsValue({areaId:void 0})},We=function(r){i.current.pageNum=r.current,i.current.pageSize=r.pageSize,M()},ee=function(r){var n=G.find(function(l){return l.id===r})||(x==null?void 0:x.warehouseMap.get(r));return console.log("warehouse:",n),console.log("warehouseName:",(n==null?void 0:n.warehouseName)||""),(n==null?void 0:n.warehouseName)||""},ne=function(r){console.log("getAreaName id:",r);var n=Q.find(function(l){return l.id===r})||(x==null?void 0:x.areaMap.get(r));return console.log("area:",n),console.log((n==null?void 0:n.areaName)||""),(n==null?void 0:n.areaName)||""},re=h==="warehouse"||h==="area"?[{title:"\u4ED3\u5E93",dataIndex:"warehouseId",render:function(r){return(0,e.jsx)("div",{children:ee(r)})},onCell:function(r,n){return{rowSpan:we["".concat(n,"-0")]||0}}}].concat(y()(h==="area"?[{title:"\u5E93\u533A",dataIndex:"areaId",render:function(r,n){var l=ne(r);return(0,e.jsx)("div",{children:l})}}]:[]),[{title:"\u5546\u54C1\u4FE1\u606F",dataIndex:h==="warehouse"?"warehouseIdAndItemId":"areaIdAndItemId",render:function(r,n){return console.log("\u5546\u54C1\u4FE1\u606F queryType:",h),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:n.item.itemName}),n.item.itemCode&&(0,e.jsxs)("div",{children:["\u5546\u54C1\u7F16\u53F7\uFF1A",n.item.itemCode]})]})}},{title:"\u89C4\u683C\u4FE1\u606F",dataIndex:"skuId",render:function(r,n){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:n.itemSku.skuName}),n.itemSku.skuCode&&(0,e.jsxs)("div",{children:["\u89C4\u683C\u7F16\u53F7\uFF1A",n.itemSku.skuCode]})]})}},{title:"\u5E93\u5B58",dataIndex:"quantity",align:"right",render:function(r){return(0,e.jsx)(D.Z,{value:r,precision:0,valueStyle:{fontSize:"14px"}})}}]):[{title:"\u5546\u54C1\u4FE1\u606F",dataIndex:"itemId",render:function(r,n){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:n.item.itemName}),n.item.itemCode&&(0,e.jsxs)("div",{children:["\u5546\u54C1\u7F16\u53F7\uFF1A",n.item.itemCode]})]})}},{title:"\u89C4\u683C\u4FE1\u606F",dataIndex:"skuId",render:function(r,n){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:n.itemSku.skuName}),n.itemSku.skuCode&&(0,e.jsxs)("div",{children:["\u89C4\u683C\u7F16\u53F7\uFF1A",n.itemSku.skuCode]})]})}},{title:"\u4ED3\u5E93",dataIndex:"skuIdAndWarehouseId",render:function(r,n){return(0,e.jsx)("div",{children:ee(n.warehouseId)})}},{title:"\u6240\u5C5E\u5E93\u533A",dataIndex:"areaName",render:function(r,n){return(0,e.jsx)("div",{children:ne(n.areaId)})}},{title:"\u5E93\u5B58",dataIndex:"quantity",align:"right",render:function(r){return(0,e.jsx)(D.Z,{value:r,precision:0,valueStyle:{fontSize:"14px"}})}}];return console.log("columns:",re),(0,e.jsxs)(s._z,{children:[(0,e.jsx)(F.Z,{children:(0,e.jsx)(m.Z,{form:b,layout:"inline",onValuesChange:function(r){Object.entries(r).forEach(function(n){var l=o()(n,2),u=l[0],O=l[1];i.current[u]=O})},children:(0,e.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[(0,e.jsx)("div",{style:{width:"calc(100% / 3)",padding:"8px"},children:(0,e.jsx)(m.Z.Item,{label:"\u7EF4\u5EA6",name:"queryType",initialValue:h,children:(0,e.jsxs)(E.ZP.Group,{onChange:Re,children:[(0,e.jsx)(E.ZP.Button,{value:"warehouse",children:"\u4ED3\u5E93"}),(0,e.jsx)(E.ZP.Button,{value:"area",children:"\u5E93\u533A"}),(0,e.jsx)(E.ZP.Button,{value:"item",children:"\u5546\u54C1"})]})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 3)",padding:"8px"},children:(0,e.jsx)(m.Z.Item,{label:"\u4ED3\u5E93",name:"warehouseId",children:(0,e.jsx)(T.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u4ED3\u5E93",onChange:Fe,allowClear:!0,showSearch:!0,optionFilterProp:"label",children:G.map(function(a){return(0,e.jsx)(Z,{value:a.id,label:a.warehouseName,children:a.warehouseName},a.id)})})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 3)",padding:"8px"},children:(0,e.jsx)(m.Z.Item,{label:"\u5E93\u533A",name:"areaId",children:(0,e.jsx)(T.Z,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u5E93\u533A",disabled:!i.current.warehouseId||h==="item",allowClear:!0,showSearch:!0,optionFilterProp:"label",children:Q.filter(function(a){return a.warehouseId===i.current.warehouseId}).map(function(a){return(0,e.jsx)(Z,{value:a.id,label:a.areaName,children:a.areaName},a.id)})})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 3)",padding:"8px"},children:(0,e.jsx)(m.Z.Item,{label:"\u5546\u54C1\u540D\u79F0",name:"itemName",children:(0,e.jsx)(j.Z,{placeholder:"\u5546\u54C1\u540D\u79F0",allowClear:!0})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 3)",padding:"8px"},children:(0,e.jsx)(m.Z.Item,{label:"\u5546\u54C1\u7F16\u53F7",name:"itemCode",children:(0,e.jsx)(j.Z,{placeholder:"\u5546\u54C1\u7F16\u53F7",allowClear:!0})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 3)",padding:"8px"},children:(0,e.jsx)(m.Z.Item,{label:"\u89C4\u683C\u540D\u79F0",name:"skuName",children:(0,e.jsx)(j.Z,{placeholder:"\u89C4\u683C\u540D\u79F0",allowClear:!0})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 3)",padding:"8px"},children:(0,e.jsx)(m.Z.Item,{label:"\u89C4\u683C\u7F16\u53F7",name:"skuCode",children:(0,e.jsx)(j.Z,{placeholder:"\u89C4\u683C\u7F16\u53F7",allowClear:!0})})}),(0,e.jsx)("div",{style:{width:"calc(100% / 3)",padding:"8px"},children:(0,e.jsxs)(m.Z.Item,{children:[(0,e.jsx)(d.ZP,{type:"primary",icon:(0,e.jsx)(P.Z,{}),onClick:q,children:"\u641C\u7D22"}),(0,e.jsx)(d.ZP,{icon:(0,e.jsx)(te.Z,{}),onClick:Ue,style:{marginLeft:8},children:"\u91CD\u7F6E"})]})})]})})}),(0,e.jsxs)(F.Z,{style:{marginTop:"20px"},children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"16px"},children:[(0,e.jsx)("div",{style:{fontSize:"large"},children:"\u5E93\u5B58\u7EDF\u8BA1"}),(0,e.jsx)(c.Z,{checked:J,onChange:Be,children:"\u8FC7\u6EE4\u6389\u5E93\u5B58\u4E3A0\u7684\u5546\u54C1"})]}),(0,e.jsx)(I.Z,{dataSource:pe,columns:re,rowKey:function(r){return"".concat(r.skuId,"-").concat(r.warehouseId,"-").concat(r.areaId||"")},loading:ce,bordered:!0,pagination:{current:i.current.pageNum,pageSize:i.current.pageSize,total:ye,showSizeChanger:!0,onChange:We},scroll:{x:"max-content"}})]})]})};w.default=ie},2377:function(ae,w,t){t.d(w,{B3:function(){return R},Wc:function(){return B}});var L=t(90228),y=t.n(L),U=t(87999),v=t.n(U),A=t(61032),g=t(18606);function R(d){return C.apply(this,arguments)}function C(){return C=v()(y()().mark(function d(c){return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,A.request)("/api/wms/inventory/list",{method:"GET",params:c}));case 1:case"end":return s.stop()}},d)})),C.apply(this,arguments)}function B(d,c){return o.apply(this,arguments)}function o(){return o=v()(y()().mark(function d(c,I){return y()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,A.request)("/api/wms/inventory/boardList/".concat(I),{method:"GET",params:c}));case 1:case"end":return P.stop()}},d)})),o.apply(this,arguments)}function p(d){return request("/api/wms/inventory/".concat(d),{method:"GET"})}function T(d){return m.apply(this,arguments)}function m(){return m=_asyncToGenerator(_regeneratorRuntime().mark(function d(c){return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",request("/api/wms/inventory",{method:"POST",data:c}));case 1:case"end":return s.stop()}},d)})),m.apply(this,arguments)}function S(d){return D.apply(this,arguments)}function D(){return D=_asyncToGenerator(_regeneratorRuntime().mark(function d(c){return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",request("/api/wms/inventory",{method:"PUT",data:c}));case 1:case"end":return s.stop()}},d)})),D.apply(this,arguments)}function F(d){return E.apply(this,arguments)}function E(){return E=_asyncToGenerator(_regeneratorRuntime().mark(function d(c){return _regeneratorRuntime().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",request("/api/wms/inventory/".concat(c),{method:"DELETE"}));case 1:case"end":return s.stop()}},d)})),E.apply(this,arguments)}function j(d,c){return downLoadXlsx("/api/wms/inventory/export",{params:d},"inventory_".concat(new Date().getTime(),".xlsx"))}}}]);
